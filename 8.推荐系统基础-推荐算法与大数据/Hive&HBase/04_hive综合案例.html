
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>04_Hive综合案例 · GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-expandable-chapters-small/expandable-chapters-small.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-splitter/splitter.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="05_hBase简介与环境部署.html" />
    
    
    <link rel="prev" href="03_Hive的函数和自定义函数.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    简介
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">一 推荐系统简介</li>
        
        
    
        <li class="chapter " data-level="2.1" data-path="../day01_推荐系统介绍/01_推荐系统简介.html">
            
                <a href="../day01_推荐系统介绍/01_推荐系统简介.html">
            
                    
                    1.1_推荐系统简介
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.2" data-path="../day01_推荐系统介绍/02_推荐系统架构设计.html">
            
                <a href="../day01_推荐系统介绍/02_推荐系统架构设计.html">
            
                    
                    1.2_推荐系统架构设计
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.3" data-path="../day01_推荐系统介绍/03_推荐算法.html">
            
                <a href="../day01_推荐系统介绍/03_推荐算法.html">
            
                    
                    1.3_推荐算法
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.4" data-path="../day01_推荐系统介绍/04_案例--基于协同过滤的电影推荐.html">
            
                <a href="../day01_推荐系统介绍/04_案例--基于协同过滤的电影推荐.html">
            
                    
                    1.4_案例--基于协同过滤的电影推荐
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.5" data-path="../day01_推荐系统介绍/07_ 推荐系统评估.html">
            
                <a href="../day01_推荐系统介绍/07_ 推荐系统评估.html">
            
                    
                    1.5_推荐系统评估
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.6" data-path="../day01_推荐系统介绍/08_ 推荐系统冷启动问题.html">
            
                <a href="../day01_推荐系统介绍/08_ 推荐系统冷启动问题.html">
            
                    
                    1.6_推荐系统的冷启动问题
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">二 推荐系统算法</li>
        
        
    
        <li class="chapter " data-level="3.1" data-path="../day02_推荐算法/01_基于模型的协同过滤推荐.html">
            
                <a href="../day02_推荐算法/01_基于模型的协同过滤推荐.html">
            
                    
                    2.1_基于模型的协同过滤推荐
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.2" data-path="../day02_推荐算法/03_基于回归模型的协同过滤推荐.html">
            
                <a href="../day02_推荐算法/03_基于回归模型的协同过滤推荐.html">
            
                    
                    2.2_基于回归模型的协同过滤推荐
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.3" data-path="../day02_推荐算法/04_基于矩阵分解的协同过滤推荐.html">
            
                <a href="../day02_推荐算法/04_基于矩阵分解的协同过滤推荐.html">
            
                    
                    2.3_基于矩阵分解的协同过滤推荐
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.4" data-path="../day02_推荐算法/05_LFM算法实现.html">
            
                <a href="../day02_推荐算法/05_LFM算法实现.html">
            
                    
                    2.4_LFM算法实现
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.5" data-path="../day02_推荐算法/06_BiasSVD算法实现.html">
            
                <a href="../day02_推荐算法/06_BiasSVD算法实现.html">
            
                    
                    2.5_BiasSVD算法实现
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.6" data-path="../day02_推荐算法/07_基于内容的推荐算法.html">
            
                <a href="../day02_推荐算法/07_基于内容的推荐算法.html">
            
                    
                    2.6_基于内容的推荐算法
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.7" data-path="../day02_推荐算法/08_物品画像.html">
            
                <a href="../day02_推荐算法/08_物品画像.html">
            
                    
                    2.7_电影推荐(ContentBased)物品画像
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.8" data-path="../day02_推荐算法/09_用户画像.html">
            
                <a href="../day02_推荐算法/09_用户画像.html">
            
                    
                    2.8_电影推荐(ContentBased)用户画像
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.9" data-path="../day02_推荐算法/10_TOPN用户推荐.html">
            
                <a href="../day02_推荐算法/10_TOPN用户推荐.html">
            
                    
                    2.9_电影推荐(ContentBased)TOP-N用户推荐
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">三 Hadoop</li>
        
        
    

    
        
        <li class="header">3.1 Hadoop概述</li>
        
        
    
        <li class="chapter " data-level="5.1" data-path="../day03_Hadoop/ha1.1.html">
            
                <a href="../day03_Hadoop/ha1.1.html">
            
                    
                    01_什么是Hadoop
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.2" data-path="../day03_Hadoop/ha1.2.html">
            
                <a href="../day03_Hadoop/ha1.2.html">
            
                    
                    02_Hadoop核心组件
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.3" data-path="../day03_Hadoop/ha1.3.html">
            
                <a href="../day03_Hadoop/ha1.3.html">
            
                    
                    03_Hadoop优势
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">3.2 分布式文件系统HDFS</li>
        
        
    
        <li class="chapter " data-level="6.1" data-path="../day03_Hadoop/ha2.1.html">
            
                <a href="../day03_Hadoop/ha2.1.html">
            
                    
                    01_HDFS的使用
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.2" data-path="../day03_Hadoop/ha2.2.html">
            
                <a href="../day03_Hadoop/ha2.2.html">
            
                    
                    02_HDFS Shell操作
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.3" data-path="../day03_Hadoop/ha2.3.html">
            
                <a href="../day03_Hadoop/ha2.3.html">
            
                    
                    03_HDFS设计思路
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.4" data-path="../day03_Hadoop/ha2.4.html">
            
                <a href="../day03_Hadoop/ha2.4.html">
            
                    
                    04_HDFS架构
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.5" data-path="../day03_Hadoop/ha2.5.html">
            
                <a href="../day03_Hadoop/ha2.5.html">
            
                    
                    05_HDFS环境搭建
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">3.3 YARN&MapReduce</li>
        
        
    
        <li class="chapter " data-level="7.1" data-path="../day03_Hadoop/ha3.1.html">
            
                <a href="../day03_Hadoop/ha3.1.html">
            
                    
                    01_资源调度框架YARN
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.2" data-path="../day03_Hadoop/ha3.2.html">
            
                <a href="../day03_Hadoop/ha3.2.html">
            
                    
                    02_分布式计算框架MapReduce
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.3" data-path="../day03_Hadoop/ha3.3.html">
            
                <a href="../day03_Hadoop/ha3.3.html">
            
                    
                    03_MapReduce实战
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.4" data-path="../day03_Hadoop/ha3.5.html">
            
                <a href="../day03_Hadoop/ha3.5.html">
            
                    
                    04_MapReduce原理
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">3.4 Hadoop概念扩展</li>
        
        
    
        <li class="chapter " data-level="8.1" data-path="../day03_Hadoop/ha4.1.html">
            
                <a href="../day03_Hadoop/ha4.1.html">
            
                    
                    01_Hadoop生态系统
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="8.2" data-path="../day03_Hadoop/ha4.2.html">
            
                <a href="../day03_Hadoop/ha4.2.html">
            
                    
                    02_HDFS读写流程&高可用
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="8.3" data-path="../day03_Hadoop/ha4.3.html">
            
                <a href="../day03_Hadoop/ha4.3.html">
            
                    
                    03_Hadoop发行版选择
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">四 Hive</li>
        
        
    
        <li class="chapter " data-level="9.1" data-path="01_hive介绍.html">
            
                <a href="01_hive介绍.html">
            
                    
                    01_Hive基本概念
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.2" data-path="02_hive的shell操作.html">
            
                <a href="02_hive的shell操作.html">
            
                    
                    02_Hive的shell操作
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.3" data-path="03_Hive的函数和自定义函数.html">
            
                <a href="03_Hive的函数和自定义函数.html">
            
                    
                    03_Hive的函数和自定义函数
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="9.4" data-path="04_hive综合案例.html">
            
                <a href="04_hive综合案例.html">
            
                    
                    04_Hive综合案例
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">五 HBase</li>
        
        
    
        <li class="chapter " data-level="10.1" data-path="05_hBase简介与环境部署.html">
            
                <a href="05_hBase简介与环境部署.html">
            
                    
                    01_HBase简介与环境部署
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="10.2" data-path="06_hbase数据模型.html">
            
                <a href="06_hbase数据模型.html">
            
                    
                    02_Hbase数据模型
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="10.3" data-path="07_hbase的安装与shell操作.html">
            
                <a href="07_hbase的安装与shell操作.html">
            
                    
                    03_Hbase的安装与shell操作
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="10.4" data-path="08_HappyBase操作HBase.html">
            
                <a href="08_HappyBase操作HBase.html">
            
                    
                    04_HappyBase操作HBase
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="10.5" data-path="10_HBase组件.html">
            
                <a href="10_HBase组件.html">
            
                    
                    05_HBase组件
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">六 Spark Core</li>
        
        
    
        <li class="chapter " data-level="11.1" data-path="../day05_Spark_core/spark_core_1.html">
            
                <a href="../day05_Spark_core/spark_core_1.html">
            
                    
                    01_Spark入门
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="11.2" data-path="../day05_Spark_core/spark_core_2.html">
            
                <a href="../day05_Spark_core/spark_core_2.html">
            
                    
                    02_RDD概念介绍
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="11.3" data-path="../day05_Spark_core/spark_core_3.html">
            
                <a href="../day05_Spark_core/spark_core_3.html">
            
                    
                    03_RDD常用算子练习
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="11.4" data-path="../day05_Spark_core/spark_core_4.html">
            
                <a href="../day05_Spark_core/spark_core_4.html">
            
                    
                    04_Spark-Core实战案例_pv&uv统计
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="11.5" data-path="../day05_Spark_core/spark_core_5.html">
            
                <a href="../day05_Spark_core/spark_core_5.html">
            
                    
                    05_Spark-Core实战_ip统计
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="11.6" data-path="../day05_Spark_core/spark_core_6.html">
            
                <a href="../day05_Spark_core/spark_core_6.html">
            
                    
                    06_Spark安装部署&standalone模式介绍
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">七 Spark SQL</li>
        
        
    
        <li class="chapter " data-level="12.1" data-path="../day06_Spark_sql&Spark_streaming/s1.1.html">
            
                <a href="../day06_Spark_sql&Spark_streaming/s1.1.html">
            
                    
                    01_Spark SQL简介
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="12.2" data-path="../day06_Spark_sql&Spark_streaming/s1.2.html">
            
                <a href="../day06_Spark_sql&Spark_streaming/s1.2.html">
            
                    
                    02_DataFrame介绍
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="12.3" data-path="../day06_Spark_sql&Spark_streaming/s1.3.html">
            
                <a href="../day06_Spark_sql&Spark_streaming/s1.3.html">
            
                    
                    03_Spark SQL 处理JSON数据
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="12.4" data-path="../day06_Spark_sql&Spark_streaming/s1.4.html">
            
                <a href="../day06_Spark_sql&Spark_streaming/s1.4.html">
            
                    
                    04Spark SQL案例数据清洗
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">八 Spark Streaming</li>
        
        
    
        <li class="chapter " data-level="13.1" data-path="../day06_Spark_sql&Spark_streaming/ss1.1.html">
            
                <a href="../day06_Spark_sql&Spark_streaming/ss1.1.html">
            
                    
                    05_Spark Streaming简介
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="13.2" data-path="../day06_Spark_sql&Spark_streaming/ss1.2.html">
            
                <a href="../day06_Spark_sql&Spark_streaming/ss1.2.html">
            
                    
                    06_Spark Streaming实现WordCount
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="13.3" data-path="../day06_Spark_sql&Spark_streaming/ss1.3.html">
            
                <a href="../day06_Spark_sql&Spark_streaming/ss1.3.html">
            
                    
                    07_Spark Steaming的状态操作
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">九 电商推荐案例</li>
        
        
    
        <li class="chapter " data-level="14.1" data-path="../day07_推荐系统案例/01_个性化电商广告推荐系统介绍.html">
            
                <a href="../day07_推荐系统案例/01_个性化电商广告推荐系统介绍.html">
            
                    
                    01_个性化电商广告推荐系统介绍
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="14.2" data-path="../day07_推荐系统案例/02_根据用户行为数据创建ALS模型并召回商品.html">
            
                <a href="../day07_推荐系统案例/02_根据用户行为数据创建ALS模型并召回商品.html">
            
                    
                    02_根据用户行为数据创建ALS模型并召回商品
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="14.3" data-path="../day07_推荐系统案例/03_CTR预估数据准备.html">
            
                <a href="../day07_推荐系统案例/03_CTR预估数据准备.html">
            
                    
                    03_CTR预估数据准备
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="14.4" data-path="../day07_推荐系统案例/04_逻辑回归实现CTR预估.html">
            
                <a href="../day07_推荐系统案例/04_逻辑回归实现CTR预估.html">
            
                    
                    04_逻辑回归(LR)实现CTR预估
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="14.5" data-path="../day07_推荐系统案例/05_离线推荐处理.html">
            
                <a href="../day07_推荐系统案例/05_离线推荐处理.html">
            
                    
                    05_离线推荐处理
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="14.6" data-path="../day07_推荐系统案例/06_实时推荐.html">
            
                <a href="../day07_推荐系统案例/06_实时推荐.html">
            
                    
                    06_实时推荐
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >04_Hive综合案例</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h2 id="44-hive&#x7EFC;&#x5408;&#x6848;&#x4F8B;">4.4 hive&#x7EFC;&#x5408;&#x6848;&#x4F8B;</h2>
<ul>
<li><p>&#x5185;&#x5BB9;&#x63A8;&#x8350;&#x6570;&#x636E;&#x5904;&#x7406;</p>
<p><img src="img/hive3.png" alt=""></p>
<ul>
<li>&#x9700;&#x6C42;<ul>
<li>&#x6839;&#x636E;&#x7528;&#x6237;&#x884C;&#x4E3A;&#x4EE5;&#x53CA;&#x6587;&#x7AE0;&#x6807;&#x7B7E;&#x7B5B;&#x9009;&#x51FA;&#x7528;&#x6237;&#x6700;&#x611F;&#x5174;&#x8DA3;(&#x9605;&#x8BFB;&#x6700;&#x591A;)&#x7684;&#x6807;&#x7B7E;</li>
</ul>
</li>
</ul>
</li>
<li><p>&#x76F8;&#x5173;&#x6570;&#x636E;</p>
<p>&#x200B;    user_id article_id event_time</p>
<pre><code>11,101,2018-12-01 06:01:10
22,102,2018-12-01 07:28:12
33,103,2018-12-01 07:50:14
11,104,2018-12-01 09:08:12
22,103,2018-12-01 13:37:12
33,102,2018-12-02 07:09:12
11,101,2018-12-02 18:42:12
35,105,2018-12-03 09:21:12
22,104,2018-12-03 16:42:12
77,103,2018-12-03 18:31:12
99,102,2018-12-04 00:04:12
33,101,2018-12-04 19:10:12
11,101,2018-12-05 09:07:12
35,102,2018-12-05 11:00:12
22,103,2018-12-05 12:11:12
77,104,2018-12-05 18:02:02
99,105,2018-12-05 20:09:11
</code></pre><ul>
<li>&#x6587;&#x7AE0;&#x6570;&#x636E;</li>
</ul>
<pre><code>artical_id,artical_url,artical_keywords
101,http://www.itcast.cn/1.html,kw8|kw1
102,http://www.itcast.cn/2.html,kw6|kw3
103,http://www.itcast.cn/3.html,kw7
104,http://www.itcast.cn/4.html,kw5|kw1|kw4|kw9
105,http://www.itcast.cn/5.html,
</code></pre></li>
<li><p>&#x6570;&#x636E;&#x4E0A;&#x4F20;hdfs</p>
<pre><code class="lang-shell">hadoop fs -mkdir /tmp/demo
hadoop fs -mkdir /tmp/demo/user_action
</code></pre>
</li>
<li><p>&#x521B;&#x5EFA;&#x5916;&#x90E8;&#x8868;</p>
<ul>
<li>&#x7528;&#x6237;&#x884C;&#x4E3A;&#x8868;</li>
</ul>
<pre><code class="lang-sql"><span class="hljs-keyword">drop</span> <span class="hljs-keyword">table</span> <span class="hljs-keyword">if</span> <span class="hljs-keyword">exists</span> user_actions;
<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">EXTERNAL</span> <span class="hljs-keyword">TABLE</span> user_actions(
    user_id <span class="hljs-keyword">STRING</span>,
    article_id <span class="hljs-keyword">STRING</span>,
    time_stamp <span class="hljs-keyword">STRING</span>
)
<span class="hljs-keyword">ROW</span> <span class="hljs-keyword">FORMAT</span> <span class="hljs-keyword">delimited</span> <span class="hljs-keyword">fields</span> <span class="hljs-keyword">terminated</span> <span class="hljs-keyword">by</span> <span class="hljs-string">&apos;,&apos;</span>
LOCATION <span class="hljs-string">&apos;/tmp/demo/user_action&apos;</span>;
</code></pre>
<ul>
<li>&#x6587;&#x7AE0;&#x8868;</li>
</ul>
<pre><code class="lang-sql"><span class="hljs-keyword">drop</span> <span class="hljs-keyword">table</span> <span class="hljs-keyword">if</span> <span class="hljs-keyword">exists</span> articles;
<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">EXTERNAL</span> <span class="hljs-keyword">TABLE</span> articles(
    article_id <span class="hljs-keyword">STRING</span>,
    <span class="hljs-keyword">url</span> <span class="hljs-keyword">STRING</span>,
    key_words <span class="hljs-built_in">array</span>&lt;<span class="hljs-keyword">STRING</span>&gt;
)
<span class="hljs-keyword">ROW</span> <span class="hljs-keyword">FORMAT</span> <span class="hljs-keyword">delimited</span> <span class="hljs-keyword">fields</span> <span class="hljs-keyword">terminated</span> <span class="hljs-keyword">by</span> <span class="hljs-string">&apos;,&apos;</span> 
COLLECTION ITEMS <span class="hljs-keyword">terminated</span> <span class="hljs-keyword">BY</span> <span class="hljs-string">&apos;|&apos;</span> 
LOCATION <span class="hljs-string">&apos;/tmp/demo/article_keywords&apos;</span>;
<span class="hljs-comment">/*
key_words array&lt;STRING&gt;  &#x6570;&#x7EC4;&#x7684;&#x6570;&#x636E;&#x7C7B;&#x578B;
COLLECTION ITEMS terminated BY &apos;|&apos;  &#x6570;&#x7EC4;&#x7684;&#x5143;&#x7D20;&#x4E4B;&#x95F4;&#x7528;&apos;|&apos;&#x5206;&#x5272;
*/</span>
</code></pre>
<ul>
<li>&#x67E5;&#x770B;&#x6570;&#x636E;</li>
</ul>
<pre><code class="lang-sql"><span class="hljs-keyword">select</span> * <span class="hljs-keyword">from</span> user_actions;
<span class="hljs-keyword">select</span> * <span class="hljs-keyword">from</span> articles;
</code></pre>
<ul>
<li><p>&#x5206;&#x7EC4;&#x67E5;&#x8BE2;&#x6BCF;&#x4E2A;&#x7528;&#x6237;&#x7684;&#x6D4F;&#x89C8;&#x8BB0;&#x5F55;</p>
<ul>
<li>collect_set/collect_list&#x4F5C;&#x7528;:<ul>
<li>&#x5C06;group by&#x4E2D;&#x7684;&#x67D0;&#x5217;&#x8F6C;&#x4E3A;&#x4E00;&#x4E2A;&#x6570;&#x7EC4;&#x8FD4;&#x56DE;</li>
<li>collect_list<strong>&#x4E0D;&#x53BB;&#x91CD;</strong>&#x800C;collect_set<strong>&#x53BB;&#x91CD;</strong></li>
</ul>
</li>
<li>collect_set</li>
</ul>
<pre><code class="lang-sql"><span class="hljs-keyword">select</span> user_id,collect_set(article_id) 
<span class="hljs-keyword">from</span> user_actions <span class="hljs-keyword">group</span> <span class="hljs-keyword">by</span> user_id;
</code></pre>
<pre><code class="lang-shell">11      [&quot;101&quot;,&quot;104&quot;]
22      [&quot;102&quot;,&quot;103&quot;,&quot;104&quot;]
33      [&quot;103&quot;,&quot;102&quot;,&quot;101&quot;]
35      [&quot;105&quot;,&quot;102&quot;]
77      [&quot;103&quot;,&quot;104&quot;]
99      [&quot;102&quot;,&quot;105&quot;]
</code></pre>
<ul>
<li>collect_list</li>
</ul>
<pre><code class="lang-sql"><span class="hljs-keyword">select</span> user_id,collect_list(article_id) 
<span class="hljs-keyword">from</span> user_actions <span class="hljs-keyword">group</span> <span class="hljs-keyword">by</span> user_id;
</code></pre>
<pre><code class="lang-shell">11      [&quot;101&quot;,&quot;104&quot;,&quot;101&quot;,&quot;101&quot;]
22      [&quot;102&quot;,&quot;103&quot;,&quot;104&quot;,&quot;103&quot;]
33      [&quot;103&quot;,&quot;102&quot;,&quot;101&quot;]
35      [&quot;105&quot;,&quot;102&quot;]
77      [&quot;103&quot;,&quot;104&quot;]
99      [&quot;102&quot;,&quot;105&quot;]
</code></pre>
<ul>
<li>sort_array: &#x5BF9;&#x6570;&#x7EC4;&#x6392;&#x5E8F;</li>
</ul>
<pre><code class="lang-sql"><span class="hljs-keyword">select</span> user_id,sort_array(collect_list(article_id)) <span class="hljs-keyword">as</span> <span class="hljs-keyword">contents</span> 
<span class="hljs-keyword">from</span> user_actions <span class="hljs-keyword">group</span> <span class="hljs-keyword">by</span> user_id;
</code></pre>
<pre><code class="lang-shell">11      [&quot;101&quot;,&quot;101&quot;,&quot;101&quot;,&quot;104&quot;]
22      [&quot;102&quot;,&quot;103&quot;,&quot;103&quot;,&quot;104&quot;]
33      [&quot;101&quot;,&quot;102&quot;,&quot;103&quot;]
35      [&quot;102&quot;,&quot;105&quot;]
77      [&quot;103&quot;,&quot;104&quot;]
99      [&quot;102&quot;,&quot;105&quot;]
</code></pre>
</li>
<li><p>&#x67E5;&#x770B;&#x6BCF;&#x4E00;&#x7BC7;&#x6587;&#x7AE0;&#x7684;&#x5173;&#x952E;&#x5B57; lateral view explode</p>
<ul>
<li>explode&#x51FD;&#x6570; &#x5C06;array &#x62C6;&#x5206;</li>
</ul>
<pre><code class="lang-sql"><span class="hljs-keyword">select</span> explode(key_words) <span class="hljs-keyword">from</span> articles;
</code></pre>
<ul>
<li>lateral view &#x548C; explode &#x914D;&#x5408;&#x4F7F;&#x7528;,&#x5C06;&#x4E00;&#x884C;&#x6570;&#x636E;&#x62C6;&#x5206;&#x6210;&#x591A;&#x884C;&#x6570;&#x636E;&#xFF0C;&#x5728;&#x6B64;&#x57FA;&#x7840;&#x4E0A;&#x53EF;&#x4EE5;&#x5BF9;&#x62C6;&#x5206;&#x7684;&#x6570;&#x636E;&#x8FDB;&#x884C;&#x805A;&#x5408;</li>
</ul>
<pre><code class="lang-sql"><span class="hljs-keyword">select</span> article_id,kw <span class="hljs-keyword">from</span> articles lateral <span class="hljs-keyword">view</span> explode(key_words) t <span class="hljs-keyword">as</span> kw;
</code></pre>
<pre><code class="lang-shell">101     kw8
101     kw1
102     kw6
102     kw3
103     kw7
104     kw5
104     kw1
104     kw4
104     kw9
</code></pre>
<pre><code class="lang-sql"><span class="hljs-keyword">select</span> article_id,kw <span class="hljs-keyword">from</span> articles lateral <span class="hljs-keyword">view</span> <span class="hljs-keyword">outer</span> explode(key_words) t <span class="hljs-keyword">as</span> kw;
</code></pre>
<pre><code class="lang-shell">101     kw8
101     kw1
102     kw6
102     kw3
103     kw7
104     kw5
104     kw1
104     kw4
104     kw9
105     NULL
#&#x542B;&#x6709;outer
</code></pre>
</li>
</ul>
</li>
</ul>
<ul>
<li><p>&#x6839;&#x636E;&#x6587;&#x7AE0;id&#x627E;&#x5230;&#x7528;&#x6237;&#x67E5;&#x770B;&#x6587;&#x7AE0;&#x7684;&#x5173;&#x952E;&#x5B57;</p>
<ul>
<li>&#x539F;&#x59CB;&#x6570;&#x636E;</li>
</ul>
<pre><code class="lang-shell">101     http://www.itcast.cn/1.html     [&quot;kw8&quot;,&quot;kw1&quot;]
102     http://www.itcast.cn/2.html     [&quot;kw6&quot;,&quot;kw3&quot;]
103     http://www.itcast.cn/3.html     [&quot;kw7&quot;]
104     http://www.itcast.cn/4.html     [&quot;kw5&quot;,&quot;kw1&quot;,&quot;kw4&quot;,&quot;kw9&quot;]
105     http://www.itcast.cn/5.html     []
</code></pre>
<pre><code class="lang-sql"><span class="hljs-keyword">select</span> a.user_id, b.kw <span class="hljs-keyword">from</span> user_actions 
<span class="hljs-keyword">as</span> a <span class="hljs-keyword">left</span> <span class="hljs-keyword">outer</span> <span class="hljs-keyword">JOIN</span> (<span class="hljs-keyword">select</span> article_id,kw <span class="hljs-keyword">from</span> articles
lateral <span class="hljs-keyword">view</span> <span class="hljs-keyword">outer</span> explode(key_words) t <span class="hljs-keyword">as</span> kw) b
<span class="hljs-keyword">on</span> (a.article_id = b.article_id)
<span class="hljs-keyword">order</span> <span class="hljs-keyword">by</span> a.user_id;
</code></pre>
<pre><code class="lang-shell">11      kw1
11      kw8
11      kw5
11      kw1
11      kw4
11      kw1
11      kw9
11      kw8
11      kw1
11      kw8
22      kw1
22      kw7
22      kw9
22      kw4
22      kw5
22      kw7
22      kw3
22      kw6
33      kw8
33      kw1
33      kw3
33      kw6
33      kw7
35      NULL
35      kw6
35      kw3
77      kw9
77      kw1
77      kw7
77      kw4
77      kw5
99      kw3
99      kw6
99      NULL
</code></pre>
</li>
<li><p>&#x6839;&#x636E;&#x6587;&#x7AE0;id&#x627E;&#x5230;&#x7528;&#x6237;&#x67E5;&#x770B;&#x6587;&#x7AE0;&#x7684;&#x5173;&#x952E;&#x5B57;&#x5E76;&#x7EDF;&#x8BA1;&#x9891;&#x7387;</p>
<pre><code class="lang-sql"><span class="hljs-keyword">select</span> a.user_id, b.kw,<span class="hljs-keyword">count</span>(<span class="hljs-number">1</span>) <span class="hljs-keyword">as</span> weight 
<span class="hljs-keyword">from</span> user_actions <span class="hljs-keyword">as</span> a 
<span class="hljs-keyword">left</span> <span class="hljs-keyword">outer</span> <span class="hljs-keyword">JOIN</span> (<span class="hljs-keyword">select</span> article_id,kw <span class="hljs-keyword">from</span> articles
lateral <span class="hljs-keyword">view</span> <span class="hljs-keyword">outer</span> explode(key_words) t <span class="hljs-keyword">as</span> kw) b
<span class="hljs-keyword">on</span> (a.article_id = b.article_id)
<span class="hljs-keyword">group</span> <span class="hljs-keyword">by</span> a.user_id,b.kw 
<span class="hljs-keyword">order</span> <span class="hljs-keyword">by</span> a.user_id,weight <span class="hljs-keyword">desc</span>;
</code></pre>
<pre><code class="lang-shell">11      kw1     4
11      kw8     3
11      kw5     1
11      kw9     1
11      kw4     1
22      kw7     2
22      kw9     1
22      kw1     1
22      kw3     1
22      kw4     1
22      kw5     1
22      kw6     1
33      kw3     1
33      kw8     1
33      kw7     1
33      kw6     1
33      kw1     1
35      NULL    1
35      kw3     1
35      kw6     1
77      kw1     1
77      kw4     1
77      kw5     1
77      kw7     1
77      kw9     1
99      NULL    1
99      kw3     1
99      kw6     1
</code></pre>
</li>
<li><p>CONCAT&#xFF1A;
CONCAT(str1,str2,&#x2026;)  </p>
<p>&#x8FD4;&#x56DE;&#x7ED3;&#x679C;&#x4E3A;&#x8FDE;&#x63A5;&#x53C2;&#x6570;&#x4EA7;&#x751F;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x3002;&#x5982;&#x6709;&#x4EFB;&#x4F55;&#x4E00;&#x4E2A;&#x53C2;&#x6570;&#x4E3A;NULL &#xFF0C;&#x5219;&#x8FD4;&#x56DE;&#x503C;&#x4E3A; NULL&#x3002;</p>
<pre><code class="lang-sql"><span class="hljs-keyword">select</span> <span class="hljs-keyword">concat</span>(user_id,article_id) <span class="hljs-keyword">from</span> user_actions;
</code></pre>
<p>CONCAT_WS:</p>
<p>&#x4F7F;&#x7528;&#x8BED;&#x6CD5;&#x4E3A;&#xFF1A;CONCAT_WS(separator,str1,str2,&#x2026;)</p>
<p>CONCAT_WS() &#x4EE3;&#x8868; CONCAT With Separator &#xFF0C;&#x662F;CONCAT()&#x7684;&#x7279;&#x6B8A;&#x5F62;&#x5F0F;&#x3002;&#x7B2C;&#x4E00;&#x4E2A;&#x53C2;&#x6570;&#x662F;&#x5176;&#x5B83;&#x53C2;&#x6570;&#x7684;&#x5206;&#x9694;&#x7B26;&#x3002;&#x5206;&#x9694;&#x7B26;&#x7684;&#x4F4D;&#x7F6E;&#x653E;&#x5728;&#x8981;&#x8FDE;&#x63A5;&#x7684;&#x4E24;&#x4E2A;&#x5B57;&#x7B26;&#x4E32;&#x4E4B;&#x95F4;&#x3002;&#x5206;&#x9694;&#x7B26;&#x53EF;&#x4EE5;&#x662F;&#x4E00;&#x4E2A;&#x5B57;&#x7B26;&#x4E32;&#xFF0C;&#x4E5F;&#x53EF;&#x4EE5;&#x662F;&#x5176;&#x5B83;&#x53C2;&#x6570;&#x3002;&#x5982;&#x679C;&#x5206;&#x9694;&#x7B26;&#x4E3A; NULL&#xFF0C;&#x5219;&#x7ED3;&#x679C;&#x4E3A; NULL&#x3002;</p>
<pre><code class="lang-sql"><span class="hljs-keyword">select</span> <span class="hljs-keyword">concat_ws</span>(<span class="hljs-string">&apos;:&apos;</span>,user_id,article_id) <span class="hljs-keyword">from</span> user_actions;
</code></pre>
</li>
<li><p>&#x5C06;&#x7528;&#x6237;&#x67E5;&#x770B;&#x7684;&#x5173;&#x952E;&#x5B57;&#x548C;&#x9891;&#x7387;&#x5408;&#x5E76;&#x6210; key:value&#x5F62;&#x5F0F;</p>
<pre><code class="lang-sql"><span class="hljs-keyword">select</span> a.user_id, <span class="hljs-keyword">concat_ws</span>(<span class="hljs-string">&apos;:&apos;</span>,b.kw,<span class="hljs-keyword">cast</span> (<span class="hljs-keyword">count</span>(<span class="hljs-number">1</span>) <span class="hljs-keyword">as</span> <span class="hljs-keyword">string</span>)) <span class="hljs-keyword">as</span> kw_w 
<span class="hljs-keyword">from</span> user_actions <span class="hljs-keyword">as</span> a 
<span class="hljs-keyword">left</span> <span class="hljs-keyword">outer</span> <span class="hljs-keyword">JOIN</span> (<span class="hljs-keyword">select</span> article_id,kw <span class="hljs-keyword">from</span> articles
lateral <span class="hljs-keyword">view</span> <span class="hljs-keyword">outer</span> explode(key_words) t <span class="hljs-keyword">as</span> kw) b
<span class="hljs-keyword">on</span> (a.article_id = b.article_id)
<span class="hljs-keyword">group</span> <span class="hljs-keyword">by</span> a.user_id,b.kw;
</code></pre>
<pre><code class="lang-shell">11      kw1:4
11      kw4:1
11      kw5:1
11      kw8:3
11      kw9:1
22      kw1:1
22      kw3:1
22      kw4:1
22      kw5:1
22      kw6:1
22      kw7:2
22      kw9:1
33      kw1:1
33      kw3:1
33      kw6:1
33      kw7:1
33      kw8:1
35      1
35      kw3:1
35      kw6:1
77      kw1:1
77      kw4:1
77      kw5:1
77      kw7:1
77      kw9:1
99      1
99      kw3:1
99      kw6:1
</code></pre>
</li>
<li><p>&#x5C06;&#x7528;&#x6237;&#x67E5;&#x770B;&#x7684;&#x5173;&#x952E;&#x5B57;&#x548C;&#x9891;&#x7387;&#x5408;&#x5E76;&#x6210; key:value&#x5F62;&#x5F0F;&#x5E76;&#x6309;&#x7528;&#x6237;&#x805A;&#x5408;</p>
<pre><code class="lang-sql"><span class="hljs-keyword">select</span> cc.user_id,<span class="hljs-keyword">concat_ws</span>(<span class="hljs-string">&apos;,&apos;</span>,collect_set(cc.kw_w))
<span class="hljs-keyword">from</span>(
<span class="hljs-keyword">select</span> a.user_id, <span class="hljs-keyword">concat_ws</span>(<span class="hljs-string">&apos;:&apos;</span>,b.kw,<span class="hljs-keyword">cast</span> (<span class="hljs-keyword">count</span>(<span class="hljs-number">1</span>) <span class="hljs-keyword">as</span> <span class="hljs-keyword">string</span>)) <span class="hljs-keyword">as</span> kw_w 
<span class="hljs-keyword">from</span> user_actions <span class="hljs-keyword">as</span> a 
<span class="hljs-keyword">left</span> <span class="hljs-keyword">outer</span> <span class="hljs-keyword">JOIN</span> (<span class="hljs-keyword">select</span> article_id,kw <span class="hljs-keyword">from</span> articles
lateral <span class="hljs-keyword">view</span> <span class="hljs-keyword">outer</span> explode(key_words) t <span class="hljs-keyword">as</span> kw) b
<span class="hljs-keyword">on</span> (a.article_id = b.article_id)
<span class="hljs-keyword">group</span> <span class="hljs-keyword">by</span> a.user_id,b.kw
) <span class="hljs-keyword">as</span> cc 
<span class="hljs-keyword">group</span> <span class="hljs-keyword">by</span> cc.user_id;
</code></pre>
<pre><code class="lang-shell">11      kw1:4,kw4:1,kw5:1,kw8:3,kw9:1
22      kw1:1,kw3:1,kw4:1,kw5:1,kw6:1,kw7:2,kw9:1
33      kw1:1,kw3:1,kw6:1,kw7:1,kw8:1
35      1,kw3:1,kw6:1
77      kw1:1,kw4:1,kw5:1,kw7:1,kw9:1
99      1,kw3:1,kw6:1
</code></pre>
</li>
<li><p>&#x5C06;&#x4E0A;&#x9762;&#x805A;&#x5408;&#x7ED3;&#x679C;&#x8F6C;&#x6362;&#x6210;map</p>
<pre><code class="lang-sql"><span class="hljs-keyword">select</span> cc.user_id,str_to_map(<span class="hljs-keyword">concat_ws</span>(<span class="hljs-string">&apos;,&apos;</span>,collect_set(cc.kw_w))) <span class="hljs-keyword">as</span> wm
<span class="hljs-keyword">from</span>(
<span class="hljs-keyword">select</span> a.user_id, <span class="hljs-keyword">concat_ws</span>(<span class="hljs-string">&apos;:&apos;</span>,b.kw,<span class="hljs-keyword">cast</span> (<span class="hljs-keyword">count</span>(<span class="hljs-number">1</span>) <span class="hljs-keyword">as</span> <span class="hljs-keyword">string</span>)) <span class="hljs-keyword">as</span> kw_w 
<span class="hljs-keyword">from</span> user_actions <span class="hljs-keyword">as</span> a 
<span class="hljs-keyword">left</span> <span class="hljs-keyword">outer</span> <span class="hljs-keyword">JOIN</span> (<span class="hljs-keyword">select</span> article_id,kw <span class="hljs-keyword">from</span> articles
lateral <span class="hljs-keyword">view</span> <span class="hljs-keyword">outer</span> explode(key_words) t <span class="hljs-keyword">as</span> kw) b
<span class="hljs-keyword">on</span> (a.article_id = b.article_id)
<span class="hljs-keyword">group</span> <span class="hljs-keyword">by</span> a.user_id,b.kw
) <span class="hljs-keyword">as</span> cc 
<span class="hljs-keyword">group</span> <span class="hljs-keyword">by</span> cc.user_id;
</code></pre>
<pre><code class="lang-shell">11      {&quot;kw1&quot;:&quot;4&quot;,&quot;kw4&quot;:&quot;1&quot;,&quot;kw5&quot;:&quot;1&quot;,&quot;kw8&quot;:&quot;3&quot;,&quot;kw9&quot;:&quot;1&quot;}
22      {&quot;kw1&quot;:&quot;1&quot;,&quot;kw3&quot;:&quot;1&quot;,&quot;kw4&quot;:&quot;1&quot;,&quot;kw5&quot;:&quot;1&quot;,&quot;kw6&quot;:&quot;1&quot;,&quot;kw7&quot;:&quot;2&quot;,&quot;kw9&quot;:&quot;1&quot;}
33      {&quot;kw1&quot;:&quot;1&quot;,&quot;kw3&quot;:&quot;1&quot;,&quot;kw6&quot;:&quot;1&quot;,&quot;kw7&quot;:&quot;1&quot;,&quot;kw8&quot;:&quot;1&quot;}
35      {&quot;1&quot;:null,&quot;kw3&quot;:&quot;1&quot;,&quot;kw6&quot;:&quot;1&quot;}
77      {&quot;kw1&quot;:&quot;1&quot;,&quot;kw4&quot;:&quot;1&quot;,&quot;kw5&quot;:&quot;1&quot;,&quot;kw7&quot;:&quot;1&quot;,&quot;kw9&quot;:&quot;1&quot;}
99      {&quot;1&quot;:null,&quot;kw3&quot;:&quot;1&quot;,&quot;kw6&quot;:&quot;1&quot;}
</code></pre>
</li>
<li><p>&#x5C06;&#x7528;&#x6237;&#x7684;&#x9605;&#x8BFB;&#x504F;&#x597D;&#x7ED3;&#x679C;&#x4FDD;&#x5B58;&#x5230;&#x8868;&#x4E2D;</p>
<pre><code class="lang-sql"><span class="hljs-keyword">create</span> <span class="hljs-keyword">table</span> user_kws <span class="hljs-keyword">as</span> 
<span class="hljs-keyword">select</span> cc.user_id,str_to_map(<span class="hljs-keyword">concat_ws</span>(<span class="hljs-string">&apos;,&apos;</span>,collect_set(cc.kw_w))) <span class="hljs-keyword">as</span> wm
<span class="hljs-keyword">from</span>(
<span class="hljs-keyword">select</span> a.user_id, <span class="hljs-keyword">concat_ws</span>(<span class="hljs-string">&apos;:&apos;</span>,b.kw,<span class="hljs-keyword">cast</span> (<span class="hljs-keyword">count</span>(<span class="hljs-number">1</span>) <span class="hljs-keyword">as</span> <span class="hljs-keyword">string</span>)) <span class="hljs-keyword">as</span> kw_w 
<span class="hljs-keyword">from</span> user_actions <span class="hljs-keyword">as</span> a 
<span class="hljs-keyword">left</span> <span class="hljs-keyword">outer</span> <span class="hljs-keyword">JOIN</span> (<span class="hljs-keyword">select</span> article_id,kw <span class="hljs-keyword">from</span> articles
lateral <span class="hljs-keyword">view</span> <span class="hljs-keyword">outer</span> explode(key_words) t <span class="hljs-keyword">as</span> kw) b
<span class="hljs-keyword">on</span> (a.article_id = b.article_id)
<span class="hljs-keyword">group</span> <span class="hljs-keyword">by</span> a.user_id,b.kw
) <span class="hljs-keyword">as</span> cc 
<span class="hljs-keyword">group</span> <span class="hljs-keyword">by</span> cc.user_id;
</code></pre>
</li>
<li><p>&#x4ECE;&#x8868;&#x4E2D;&#x901A;&#x8FC7;key&#x67E5;&#x8BE2;map&#x4E2D;&#x7684;&#x503C;</p>
<pre><code class="lang-sql"><span class="hljs-keyword">select</span> user_id, wm[<span class="hljs-string">&apos;kw1&apos;</span>] <span class="hljs-keyword">from</span> user_kws;
</code></pre>
<pre><code class="lang-shell">11      4
22      1
33      1
35      NULL
77      1
99      NULL
</code></pre>
</li>
<li><p>&#x4ECE;&#x8868;&#x4E2D;&#x83B7;&#x53D6;map&#x4E2D;&#x6240;&#x6709;&#x7684;key &#x548C; &#x6240;&#x6709;&#x7684;value</p>
<pre><code class="lang-sql"><span class="hljs-keyword">select</span> user_id,map_keys(wm),map_values(wm) <span class="hljs-keyword">from</span> user_kws;
</code></pre>
<pre><code class="lang-shell">11      [&quot;kw1&quot;,&quot;kw4&quot;,&quot;kw5&quot;,&quot;kw8&quot;,&quot;kw9&quot;] [&quot;4&quot;,&quot;1&quot;,&quot;1&quot;,&quot;3&quot;,&quot;1&quot;]
22      [&quot;kw1&quot;,&quot;kw3&quot;,&quot;kw4&quot;,&quot;kw5&quot;,&quot;kw6&quot;,&quot;kw7&quot;,&quot;kw9&quot;]     [&quot;1&quot;,&quot;1&quot;,&quot;1&quot;,&quot;1&quot;,&quot;1&quot;,&quot;2&quot;,&quot;1&quot;]
33      [&quot;kw1&quot;,&quot;kw3&quot;,&quot;kw6&quot;,&quot;kw7&quot;,&quot;kw8&quot;] [&quot;1&quot;,&quot;1&quot;,&quot;1&quot;,&quot;1&quot;,&quot;1&quot;]
35      [&quot;1&quot;,&quot;kw3&quot;,&quot;kw6&quot;]       [null,&quot;1&quot;,&quot;1&quot;]
77      [&quot;kw1&quot;,&quot;kw4&quot;,&quot;kw5&quot;,&quot;kw7&quot;,&quot;kw9&quot;] [&quot;1&quot;,&quot;1&quot;,&quot;1&quot;,&quot;1&quot;,&quot;1&quot;]
99      [&quot;1&quot;,&quot;kw3&quot;,&quot;kw6&quot;]       [null,&quot;1&quot;,&quot;1&quot;]
</code></pre>
</li>
<li><p>&#x7528;lateral view explode&#x628A;map&#x4E2D;&#x7684;&#x6570;&#x636E;&#x8F6C;&#x6362;&#x6210;&#x591A;&#x5217;</p>
<pre><code class="lang-sql"><span class="hljs-keyword">select</span> user_id,keyword,weight <span class="hljs-keyword">from</span> user_kws lateral <span class="hljs-keyword">view</span> explode(wm) t <span class="hljs-keyword">as</span> keyword,weight;
</code></pre>
<pre><code class="lang-shell">11      kw1     4
11      kw4     1
11      kw5     1
11      kw8     3
11      kw9     1
22      kw1     1
22      kw3     1
22      kw4     1
22      kw5     1
22      kw6     1
22      kw7     2
22      kw9     1
33      kw1     1
33      kw3     1
33      kw6     1
33      kw7     1
33      kw8     1
35      1       NULL
35      kw3     1
35      kw6     1
77      kw1     1
77      kw4     1
77      kw5     1
77      kw7     1
77      kw9     1
99      1       NULL
99      kw3     1
99      kw6     1
</code></pre>
</li>
</ul>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="03_Hive的函数和自定义函数.html" class="navigation navigation-prev " aria-label="Previous page: 03_Hive的函数和自定义函数">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="05_hBase简介与环境部署.html" class="navigation navigation-next " aria-label="Next page: 01_HBase简介与环境部署">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"04_Hive综合案例","level":"9.4","depth":1,"next":{"title":"01_HBase简介与环境部署","level":"10.1","depth":1,"path":"Hive&HBase/05_hBase简介与环境部署.md","ref":"Hive&HBase/05_hBase简介与环境部署.md","articles":[]},"previous":{"title":"03_Hive的函数和自定义函数","level":"9.3","depth":1,"path":"Hive&HBase/03_Hive的函数和自定义函数.md","ref":"Hive&HBase/03_Hive的函数和自定义函数.md","articles":[]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{},"plugins":["mathjax","expandable-chapters-small","splitter"],"pluginsConfig":{"splitter":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"fontsettings":{"theme":"white","family":"sans","size":2},"highlight":{},"mathjax":{"forceSVG":false,"version":"2.6-latest"},"expandable-chapters-small":{},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"}},"file":{"path":"Hive&HBase/04_hive综合案例.md","mtime":"2019-06-11T08:55:04.234Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2019-06-16T09:41:09.142Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="https://cdn.mathjax.org/mathjax/2.6-latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-mathjax/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-expandable-chapters-small/expandable-chapters-small.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-splitter/splitter.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

